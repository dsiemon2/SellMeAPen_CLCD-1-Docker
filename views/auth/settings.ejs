<%- include('../layouts/auth', {
  title: 'Account Settings',
  subtitle: 'Manage your account',
  body: `

<div id="alertContainer">
  ${typeof error !== 'undefined' && error ? '<div class="alert alert-danger d-flex align-items-center"><i class="bi bi-exclamation-circle me-2"></i>' + error + '</div>' : ''}
  ${typeof success !== 'undefined' && success ? '<div class="alert alert-success d-flex align-items-center"><i class="bi bi-check-circle me-2"></i>' + success + '</div>' : ''}
</div>

<!-- User Info -->
<div class="d-flex align-items-center mb-4">
  <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center" style="width: 48px; height: 48px; font-size: 1.25rem;">
    ${typeof user !== 'undefined' && user ? user.name.charAt(0).toUpperCase() : '?'}
  </div>
  <div class="ms-3">
    <h6 class="mb-0">${typeof user !== 'undefined' && user ? user.name : 'User'}</h6>
    <small class="text-muted">${typeof user !== 'undefined' && user ? user.email : ''}</small>
  </div>
</div>

<hr class="my-4">

<!-- Security Section -->
<h6 class="fw-semibold mb-3"><i class="bi bi-shield me-2"></i>Security</h6>

<!-- MFA Status -->
<div class="card mb-3">
  <div class="card-body d-flex justify-content-between align-items-center">
    <div>
      <div class="fw-medium">Two-Factor Authentication</div>
      <small class="text-muted">
        ${typeof user !== 'undefined' && user && user.mfaEnabled ? 'Enabled - Your account is protected' : 'Add an extra layer of security'}
      </small>
    </div>
    <a href="/auth/mfa/setup" class="btn btn-sm ${typeof user !== 'undefined' && user && user.mfaEnabled ? 'btn-outline-secondary' : 'btn-primary'}">
      ${typeof user !== 'undefined' && user && user.mfaEnabled ? '<i class="bi bi-gear me-1"></i>Manage' : '<i class="bi bi-shield-plus me-1"></i>Enable'}
    </a>
  </div>
</div>

<!-- Change Password -->
<div class="card mb-3">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <div class="fw-medium">Password</div>
        <small class="text-muted">Change your account password</small>
      </div>
      <button type="button" class="btn btn-sm btn-outline-primary" data-bs-toggle="collapse" data-bs-target="#passwordSection">
        <i class="bi bi-key me-1"></i>Change
      </button>
    </div>

    <div class="collapse" id="passwordSection">
      <form method="POST" action="/auth/change-password">
        <input type="hidden" name="_csrf" value="${typeof csrfToken !== 'undefined' ? csrfToken : ''}">

        <div class="mb-3">
          <label class="form-label small">Current Password</label>
          <input type="password" class="form-control" name="currentPassword" required>
        </div>
        <div class="mb-3">
          <label class="form-label small">New Password</label>
          <input type="password" class="form-control" name="newPassword" minlength="8" required>
        </div>
        <div class="mb-3">
          <label class="form-label small">Confirm New Password</label>
          <input type="password" class="form-control" name="confirmPassword" minlength="8" required>
        </div>
        <button type="submit" class="btn btn-primary btn-sm">
          <i class="bi bi-check me-1"></i>Update Password
        </button>
      </form>
    </div>
  </div>
</div>

<hr class="my-4">

<!-- Account Actions -->
<div class="d-flex justify-content-between">
  <a href="/chat" class="btn btn-outline-secondary">
    <i class="bi bi-arrow-left me-1"></i>Back to Chat
  </a>
  <a href="/auth/logout" class="btn btn-outline-danger">
    <i class="bi bi-box-arrow-right me-1"></i>Sign Out
  </a>
</div>

`,
  scripts: ``
}) %>
